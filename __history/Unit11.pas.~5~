unit Unit11;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, Grids;

type
  TForm11 = class(TForm)
    grid1: TStringGrid;
    Button2: TButton;
    Button1: TButton;
    Edit3: TEdit;
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Edit1: TEdit;
    Edit2: TEdit;
    Button3: TButton;
    Edit4: TEdit;
    Label4: TLabel;
    procedure Button3Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form11: TForm11;

implementation

{$R *.dfm}

procedure TForm11.Button1Click(Sender: TObject);
begin
grid1.RowCount:=grid1.RowCount+1;
end;

procedure TForm11.Button2Click(Sender: TObject);
begin
grid1.RowCount:=grid1.RowCount-1;
end;

procedure TForm11.Button3Click(Sender: TObject);
var
n,a,b,j:Integer;
area,H,s1,s2,x,I:Double;
begin
a:=strtoint(Edit1.Text);
b:=strtoint(Edit2.Text);
n:=strtoint(Edit3.Text);
s1:=0;
s2:=0;
x:=a;
H:=(b-a)/n;
if(n=2) then
begin
  I:=1;
  while I<=(n/2)-1 do
  for j := 0 to grid1.RowCount - 1 do
    begin
      x:=x+H;
      s1:=s1+strtoint(grid1.Cells[0,j]);
      x:=x+H;
      s2:=s2+strtoint(grid1.Cells[0,j]);
      I:=I+1;
    end;
    x:=x+H;
    s1:=s1+strtoint(grid1.Cells[0,j]);
    area:=H/3*((strtoint(grid1.Cells[0,j])*a+4*s1+2*s2+strtoint(grid1.Cells[0,j])*b));
end;
showmessage(floattostr(area));
end;

end.
