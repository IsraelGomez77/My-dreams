unit Unit10;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, Grids, Math;

type
  TForm12 = class(TForm)
    Label1: TLabel;
    grid1: TStringGrid;
    grid2: TStringGrid;
    Button1: TButton;
    Button2: TButton;
    Button3: TButton;
    Label3: TLabel;
    Edit1: TEdit;
    Label4: TLabel;
    Edit2: TEdit;
    Label5: TLabel;
    Label6: TLabel;
    Edit3: TEdit;
    Edit4: TEdit;
    grid3: TStringGrid;
    grid4: TStringGrid;
    Button5: TButton;
    Button6: TButton;
    Button7: TButton;
    Button8: TButton;
    Button9: TButton;
    Label7: TLabel;
    Label8: TLabel;
    procedure Button9Click(Sender: TObject);
    procedure Button8Click(Sender: TObject);
    procedure Button7Click(Sender: TObject);
    procedure Button6Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form12: TForm12;

implementation

{$R *.dfm}

procedure TForm12.Button1Click(Sender: TObject);
begin
grid1.RowCount:=grid1.RowCount+1;
end;

procedure TForm12.Button2Click(Sender: TObject);
begin
grid1.RowCount:= grid1.RowCount-1;
end;

procedure TForm12.Button3Click(Sender: TObject);

var
A1,A2,A3,A4,A5,R1,k,l,j,i:INTEGER;
H1,S,S1,S2,S3,S4,S5,S6,S7,S8,S9,Y1,Y2,H2A,H2B,H2,HA,HB,CA,CB,
A,B,DA,DB,CX,DX,X,M,N,Area:Real;


begin
grid2.RowCount:=grid1.RowCount;
for i := 0 to grid1.RowCount - 1 do
 begin
      grid2.Cells[1,i]:=inttostr(strtoint(grid1.Cells[1,i])+1);
      grid2.Cells[0,i]:=floattostr(strtofloat(grid1.Cells[0,i])/strtofloat(grid2.Cells[1,i]));
      grid2.Cells[2,i]:=inttostr(strtoint(grid1.Cells[2,i])+1);
      grid2.Cells[0,i]:=floattostr(strtofloat(grid1.Cells[0,i])/strtofloat(grid2.Cells[1,i]));

 end;

 //toma datos de las cajas-edit
B:= strtofloat(edit1.Text);  //superior
A:= strtofloat(edit2.Text);  //inferior
//intervalo X
N:= strtofloat(edit3.Text);
//intervalo Y
M:= strtofloat(edit4.Text);
X:=0;


//Inicio CA
 CA:=0 ;
 for A1:= 0 to grid1.RowCount - 1 do
begin
 CA:= CA+grid3.RowCount*power(A,grid3.RowCount);
end;
//Fin CA

//Inicio CB
  CB:=0 ;
  for A2:= 0 to grid1.RowCount - 1 do
begin
CB:= CB+grid3.RowCount*power(B,grid3.RowCount);
end;
//Fin CB

//Inicio DA
DA:=0 ;
for A3:= 0 to grid1.RowCount - 1 do
begin
DA:= DA+grid4.RowCount*power(A,grid4.RowCount);
end;
//Fin DA

//Inicio DX
DX:= 0;
for A4:= 0 to grid1.RowCount - 1 do
begin
DX:= DX+grid1.RowCount*power(X,grid4.RowCount);
end;
//Fin XD

//Inicio DB
DB:=0 ;
for R1:= 0 to grid1.RowCount - 1 do
begin
DB:= DB+grid4.RowCount*power(B,grid3.RowCount);
end;
//Fin DB

//Inicio CX
CX:= 0;
for A5:= 0 to grid1.RowCount - 1 do
begin
CX:= CX+grid1.RowCount*power(X,grid3.RowCount);
end;
//Fin CX



 //Operaciones
for l := 0 to grid2.RowCount - 1 do

//Inicio for1
begin
H1:=(B-A)/N; //Paso1
S:=(grid2.RowCount*(A))* (grid2.RowCount*(CA)) + (grid2.RowCount*(A))*(grid2.RowCount*(DA)) * ((DA) - (CA/M)) + (grid2.RowCount*(B)) * (grid2.RowCount *(CB)) + (grid2.RowCount*(B))* (grid2.RowCount*(DB)) * ((DB - CB)/M); //Paso2
S1:=0; S2:=0; Y1:=CA; Y2:=CB; //Paso3
J:=1;  //Paso4
while J<=M-1 do //Paso5

// Inicio while1
 begin
     H2A:=(DA-CA)/M; //Inicio Paso6
     Y1:=Y1+H2A;
     S1:=(S1+H2A)*(grid2.RowCount*(A)) *(grid2.RowCount*(Y1));
     H2B:=(DB-CB)/M;
     Y2:=Y2+H2B; S1:=(S1+H2B)*(grid2.RowCount*(B)) *(grid2.RowCount*(Y2));  //Fin Paso6

     if J= M-1 then  //Paso7

     //Inicio if1=Paso9
     begin
       J:= J+2;
     end;   //Fin if1

      Y1:=Y1+H2A;   //Inicioo Paso8
      S2:=(S2+H2A)*(grid2.RowCount)*(A)*(grid2.RowCount)*(Y1);
      Y2:=Y2+H2B; S2:=(S2+H2B)*(grid2.RowCount)*(B)*(grid2.RowCount)*(Y2);
      //Fin Paso8
 end;
 //Fin while1


 //Paso10
 S3:=0; S6:=0; S7:=0; X:=A;
 I:=1; //Paso11

 //Paso12
 while I<=(N-1) do
 //Inicio while2
 begin
 X:=X+H1; H2:=((DX-CX)/M); //Inicio Paso13
 S3:=((S3+H2)*(grid2.RowCount))*(X)*(grid2.RowCount)*((grid2.RowCount)*(CX));
 S6:=((S6+H2)*(grid2.RowCount))*(X)*(grid2.RowCount)*((grid2.RowCount)*(DX)); //Fin paso13

 //Paso14
 if I=(N-1) then  //Inicio if2
 begin
 I:=I+2;     //Paso16
 end;
 //Fin if2

 X:=X+H1; H2:=(DX-CX)/M;   //Inicio Paso15
 S7:=(S7+2)*(grid2.RowCount*(X))*(CX)+ (grid2.RowCount*(X))*(DX);
 end;
 //Fin while2


 S4:=0; S5:=0; S8:=0; S9:=0; X:=A-H1;  //Paso17
 I:=1;  //Paso18

 //Paso19
 while I<= (N-1) do //Inicio while3
 begin
 X:=(X+2)*(H1); //Inicio Paso20
 Y1:=CX; Y2:=CX+H1;
 HA:=(DX-CX)/M;
 HB:=((DX+H1)-(CX+H1))/M; //Fin Paso20
 J:=1;  //Paso21

 //Paso22
 while j<=(M-1) do//Inicio while4
 begin
 Y1:=Y1+HA; //Inicio paso23
 S4:=(S4*HA)*(grid2.RowCount*(X))*(grid2.RowCount)*(Y1);  //Fin paso23
 //Paso24
 if I =(N-1) then //Inicio if3
 begin
 //Paso26
 if J=(M-1) then  //Inicio if4
  begin
 //Paso30
  J:=J+2;
  end;//Fin if4
  Y1:=Y1+HA; //Inicio Paso27
  S5:=(S5+HA)*(grid2.RowCount*(X))*(grid2.RowCount)*(Y1);  //Fin Paso27
 end;//Fin if3
 Y2:=Y2+HB;  //Inicio Paso25
 S8:=(S8+HB)*(grid2.RowCount)+(H1)*(grid2.RowCount)*(Y2);   //Fin Paso25
 //S8:=(S8+HB)*(grid2.RowCount*((X)+(H1)))*(grid2.RowCount)*(Y2);
 if I=(N-1) then //Inicio if5
 begin
 //Paso30
 J:=J+2;
 end;//Fin if5
 //Paso29
  Y2:=Y2+HB; S9:=(S9+HA)*(grid2.RowCount)+(H1)*(grid2.RowCount)*(Y2);
  //Y2:=Y2+HB; S9:=(S9+HA)*(grid2.RowCount*((X)+(H1)))*(grid2.RowCount)*(Y2);
 end;
 //Fin while4
 I:=1+2;  //Paso31
 end;
 //Fin while3

 //Paso32
 Area:=(H1/9)*(S+4)*(S1+S3+S6+S9)+2*S2+S7+ 16*S4+8*S5+S8;
end;
//Fin for1

//Paso33
 ShowMessage('El área aproximada= '+ floattostr(Area));
end;

procedure TForm12.Button6Click(Sender: TObject);
begin
grid3.RowCount:= grid3.RowCount+1;
end;

procedure TForm12.Button7Click(Sender: TObject);
begin
grid3.RowCount:= grid3.RowCount-1;
end;

procedure TForm12.Button8Click(Sender: TObject);
begin
grid4.RowCount:= grid4.RowCount+1;
end;

procedure TForm12.Button9Click(Sender: TObject);
begin
grid4.RowCount:= grid4.RowCount-1;
end;

end.
